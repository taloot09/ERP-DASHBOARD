{% extends 'base.html' %}

{% block main_content %}
<div class="report-container">
    <h2>Sales Report</h2>

    <!-- Summary Box -->
    <div class="summary-box">
        <h3>Summary</h3>
        <p>Total Sales: <span class="highlight-green">{{ total_sales }}</span></p>
        <p>Total Quantity: <span>{{ total_quantity }}</span></p>
        <p>Total Due Balance: <span class="highlight-red">{{ total_due_balance }}</span></p>
        <p>Total Paid Amount: <span>{{ total_paid }}</span></p>
        <p>Total Wholesales (Tons): <span>{{ total_wholesales }}</span></p>
        <p>Total Normal Sales (Bags): <span>{{ total_normal_sales }}</span></p>
        <button id="download-pdf-btn">Download PDF</button>
    </div>

    <!-- Sales Table -->
    <table class="sales-table">
        <thead>
            <tr>
                <th>Invoice ID</th>
                <th>Customer Name</th>
                <th>Due Balance</th>
                <th>Paid Amount</th>
                <th>Product Name</th>
                <th>Wholesales (Tons)</th>
                <th>Normal Sales (Bags)</th>
                <th>Quantity</th>
                <th>Total</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for sale in sales_data %}
            <tr>
                <td>{{ sale.invoice_number }}</td>
                <td>{{ sale.customer_name }}</td>
                <td>{{ sale.due_balance }}</td>
                <td>{{ sale.paid }}</td>
                <td>{{ sale.product_name }}</td>
                <td>
                    {% if sale.unit == 'ton' %}
                        {{ sale.quantity }}
                    {% else %}
                        N/A
                    {% endif %}
                </td>
                <td>
                    {% if sale.unit == 'bag' %}
                        {{ sale.quantity }}
                    {% else %}
                        N/A
                    {% endif %}
                </td>
                <td>{{ sale.quantity }}</td>
                <td>{{ sale.total }}</td>
                <td>{{ sale.date }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th colspan="2">Total</th>
                <th>{{ total_due_balance }}</th>
                <th>{{ total_paid }}</th>
                <th></th>
                <th>{{ total_wholesales }}</th>
                <th>{{ total_normal_sales }}</th>
                <th>{{ total_quantity }}</th>
                <th>{{ total_sales }}</th>
                <th></th>
            </tr>
        </tfoot>
    </table>
</div>

<style>
    .report-container {
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .report-container h2 {
        text-align: center;
        color: #333;
        margin-bottom: 20px;
        font-size: 24px;
    }

    .summary-box {
        padding: 15px;
        margin-bottom: 20px;
        background-color: #e9f7ef;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .summary-box h3 {
        text-align: center;
        margin-bottom: 10px;
        font-size: 20px;
    }

    .summary-box p {
        font-size: 16px;
        margin: 5px 0;
    }

    .highlight-green {
        color: #28a745;
        font-weight: bold;
    }

    .highlight-red {
        color: #dc3545;
        font-weight: bold;
    }

    .sales-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }

    .sales-table th, .sales-table td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
    }

    .sales-table th {
        background-color: #4CAF50;
        color: white;
        font-weight: bold;
    }

    .sales-table td {
        font-size: 16px;
    }

    #download-pdf-btn {
        display: block;
        margin: 20px auto 0;
        padding: 10px 30px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }

    #download-pdf-btn:hover {
        background-color: #218838;
    }
</style>

<script>
    document.getElementById('download-pdf-btn').addEventListener('click', function() {
        window.location.href = "{% url 'download_sales_report_pdf' %}";
    });
</script>
{% endblock %}
